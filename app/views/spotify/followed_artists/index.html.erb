<section>
  <div class='container mx-auto m-5 mt-10'>
    <h1 class='text-4xl font-bold text-green-spotify text-center'>Spotify Library</h1>
    <button type="button" data-action="dialog#open">Open modal</button>

    <div class='container mx-auto m-5 mt-10'>
      <% if !current_user %>
        <p class='my-5 text-green-spotify text-lg'>Log in or sign up to start enjoying your custom spotify library !</p>

        <div class='flex'>
          <%= link_to "Log in", new_user_session_path, class: "mr-2 rounded-md bg-green-spotify px-2.5 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-green-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-600" %>
          <%= link_to "Sign up", new_user_registration_path, class: "rounded-md bg-green-700 px-2.5 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-green-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-600" %>
        </div>
      <% elsif current_user && !current_user&.spotify_data? %>
        <p class='my-5 text-white'>You're logged in ðŸ¤˜ ! Now, connect your Spotify account ðŸš€</p>

        <%= link_to 'Sign in with Spotify', '/auth/spotify', method: :post, class: "rounded-md bg-indigo-600 px-2.5 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600" %>
      <% else %>
        <!-- Tags -->
        <div class='container my-5'>

          <h3 class='text-xl text-white'>Ajouter un tag</h3>

          <% @tags.each do |tag| %>
            <span class="inline-flex items-center rounded-full bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10"><%= tag %></span>
          <% end %>
        </div>


        <h3 class='text-xl text-white'>Followed Artists (<%= @followed_artists_count %>)</h3>

        <!-- Button "Refresh my artists" -->
        <button
          data-controller="spotify"
          data-action="click->spotify#fetchArtists"
          data-url="<%= spotify_followed_artists_path %>"
          class="rounded-md bg-green-spotify px-2.5 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-green-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 rounded-full">
          <!-- Hidden spinner -->
          <span data-spotify-target="spinner" class="hidden inline-block h-4 w-4 animate-spin rounded-full border-4 border-solid border-current border-e-transparent align-[-0.125em] text-surface motion-reduce:animate-[spin_1.5s_linear_infinite] dark:text-white" role="status">
            <span class="!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]">Loading...</span>
          </span>
          Refresh my artists
        </button>

        <div class='grid xl:grid-cols-6 lg:grid-cols-6 md:grid-cols-4 grid-cols-2 gap-4 mt-5'>
          <!-- Artist list -->
          <% @followed_artists.each do |artist| %>
            <%= render "artist", artist: artist %>
          <% end %>
        </div>

        <div class='container text-white text-md'>
          <%= paginate @followed_artists, remote: true, class: "mx-auto" %>
        </div>
      <% end %>
    </div>
  </div>
</section>

<!-- Modal -->
<div data-controller="dialog" data-action="click->dialog#backdropClose">
  <dialog data-dialog-target="dialog">
    <p>The modal's content here</p>

    <button type="button" data-action="dialog#close" autofocus>Cancel</button>
  </dialog>
</div>